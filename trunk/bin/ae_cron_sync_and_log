#!/bin/bash

# ae_cron - call for layman -S; eix-sync, ae_cron and send out to $1
# GPL-2
# version: 2.0
# alexdu@forums.gentoo.org

# Usage:
# # crontab -e
# 30 22 * * *	/usr/bin/ae_cron_sync_and_log root

# get config
. /etc/async.emerge.conf

# to-do: add/redo to log

( \
	echo "*** Layman ***"
	/usr/bin/layman -S -q
	echo "*** EIX-sync ***"
	/usr/bin/eix-sync -q
	echo
	/usr/bin/ae_cron
	/usr/bin/ae_state -dwc
) 2>&1 | /usr/bin/ansi2html --bg=dark > /tmp/ae_state.html
# emerge net-mail/email
email -b -n root -f root -s "Async Emerge" -a /tmp/ae_state.html $1

